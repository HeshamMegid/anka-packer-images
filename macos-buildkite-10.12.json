{
  "builders": [
    {
     "type": "veertu-anka",
     "vm_name": "{{ user `vm_name` }}-r{{ user `build_number` }}",
     "source_vm_name":  "{{user `source_vm`}}",
     "boot_delay": "2s"
    }
  ],
  "provisioners": [
    {
      "destination": "/Users/vmkite/com.macstadium.vmkite-buildkite-agent.plist",
      "source": "scripts/macos/support/com.macstadium.vmkite-buildkite-agent.plist",
      "type": "file"
    },
    {
      "destination": "/Users/vmkite/vmkite-buildkite-agent.sh",
      "source": "scripts/macos/support/vmkite-buildkite-agent.sh",
      "type": "file"
    },
    {
      "destination": "/tmp/buildkite-hooks",
      "source": "hooks",
      "type": "file"
    },
    {
      "environment_vars": [
        "BUILDKITE_BUILD_NUMBER={{user `buildkite_build_number`}}",
        "BUILDKITE_BRANCH={{user `buildkite_branch`}}",
        "BUILDKITE_COMMIT={{user `buildkite_commit`}}"
      ],
      "scripts": [
        "scripts/macos/buildkite.sh"
      ],
      "type": "shell"
    }
  ],
  "variables": {
    "vm_name": "macos-buildkite-10.12",
    "build_number": "1",
    "source_vm": "",
    "fastlane_user": "{{env `FASTLANE_USER`}}",
    "fastlane_password": "{{env `FASTLANE_PASSWORD`}}",
    "xcode_version": "8.3.2",
    "buildkite_build_number": "{{env `BUILDKITE_BUILD_NUMBER`}}",
    "buildkite_branch": "{{env `BUILDKITE_BRANCH`}}",
    "buildkite_commit": "{{env `BUILDKITE_COMMIT`}}"
  }
}
